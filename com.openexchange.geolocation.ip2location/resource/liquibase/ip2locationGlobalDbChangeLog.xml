<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="urn:liquibase"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="urn:liquibase /liquibase/dbchangelog-3.0.xsd"
    logicalFilePath="ip2locationGlobalDbChangeLog">

    <!-- ******************************************************** -->
    <!-- ************** Release 7.10.2 starts here ************** -->
    <!-- ******************************************************** -->
	<changeSet id="7.10.2:ip2location:create" author="ioannis.chouklis@open-xchange.com">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="ip2location" />
            </not>
        </preConditions>
        <comment>
            Add table 'ip2location' to persist the ip2Location geolocation ip database
        </comment>
        <sql>
            CREATE TABLE `ip2location`(
    			`ip_from` INT(10) UNSIGNED,
    			`ip_to` INT(10) UNSIGNED,
    			`country_code` CHAR(2),
    			`country_name` VARCHAR(64),
    			`region_name` VARCHAR(128),
    			`city_name` VARCHAR(128),
    			`latitude` DOUBLE,
    			`longitude` DOUBLE,
    			`zip_code` VARCHAR(30),
    			INDEX `idx_ip_from` (`ip_from`),
    			INDEX `idx_ip_to` (`ip_to`),
    			INDEX `idx_ip_from_to` (`ip_from`, `ip_to`)
			)  ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
        </sql>
        <rollback>
            <dropTable tableName="ip2location"/>
        </rollback>
    </changeSet>
</databaseChangeLog>
