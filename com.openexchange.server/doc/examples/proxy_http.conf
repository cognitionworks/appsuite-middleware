### proxy_http configuration for OX hosts

<IfModule mod_proxy_http.c>
    <Location /webservices>
      Order Deny,Allow
      Deny from all
      Allow from 127.0.0.1
    </Location>

    # Don't function as a forward proxy
    ProxyRequests Off

    # Preserve the host information for the backend server
    ProxyPreserveHost On

    # The default cluster configuration
    <Proxy balancer://oxcluster>
      Order deny,allow
      Allow from all
      BalancerMember http://localhost:8080 timeout=100 smax=0 ttl=60 retry=60 loadfactor=50 keepalive=On route=OX1
      ProxySet stickysession=JSESSIONID
    </Proxy>

    # Define another Proxy Container with drastically different timeout for the
    # eas clients. Microsoft recommends a minimum value of 15 minutes. Setting
    # the value lower than the one defined as
    # com.openexchange.usm.eas.ping.max_heartbeat in eas.properties will lead to
    # connection timeouts for eas clients and lower battery life for mobile
    # clients.
    # See http://support.microsoft.com/?kbid=905013 for additional information.
    <Proxy balancer://oxcluster_eas>
      Order deny,allow
      Allow from all
      BalancerMember http://localhost:8080 timeout=900 smax=0 ttl=60 retry=60 loadfactor=50 keepalive=On route=OX1
      ProxySet stickysession=JSESSIONID
    </Proxy>

    # ProxyPass for default Proxy container
    <Proxy /ajax>
      ProxyPass balancer://oxcluster/ajax
    </Proxy>
    <Proxy /appsuite/api>
      ProxyPass balancer://oxcluster/ajax
    </Proxy>
    <Proxy /servlet>
      ProxyPass balancer://oxcluster/servlet
    </Proxy>
    <Proxy /infostore>
      ProxyPass balancer://oxcluster/infostore
    </Proxy>
    <Proxy /publications>
      ProxyPass balancer://oxcluster/publications
    </Proxy>
    <Proxy /usm-json>
      ProxyPass balancer://oxcluster/usm-json
    </Proxy>
    <Proxy /realtime>
      ProxyPass balancer://oxcluster/realtime
    </Proxy>
    <Proxy /webservices>
      ProxyPass balancer://oxcluster/webservices
    </Proxy>

    # ProxyPass for eas specific Proxy container with longer timeout
    <Proxy /Microsoft-Server-ActiveSync>
      ProxyPass balancer://oxcluster_eas/Microsoft-Server-ActiveSync
    </Proxy>

</IfModule>
