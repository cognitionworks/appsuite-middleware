define("io.ox/calendar/edit/extensions/recurrence/view-recurrence",["io.ox/calendar/edit/binding-util","text!io.ox/calendar/edit/extensions/recurrence/tpl/recurrence.html","gettext!io.ox/calendar/edit/main"],function(a,b,c){var d,e={STARTS_ON:c("Starts on"),ENDS:c("Ends"),NEVER:c("Never"),ON:c("on"),AFTER:c("after"),TIMES:c("times"),DAILY:c("Daily"),WEEKLY:c("Weekly"),MONTHLY:c("Monthly"),YEARLY:c("Yearly"),EVERY:c("Every"),DAY:c("day"),WEEKS:c("weeks"),AT:c("at"),TH_DAY_EVERY:c("th day every"),TH_MONTH
:c("th month"),FIRST:c("First"),SECOND:c("Second"),THIRD:c("Third"),FOURTH:c("Fourth"),LAST:c("Last"),TH:c("th"),IN:c("in")},f=[{value:1<<0,label:c("Sunday")},{value:1<<1,label:c("Monday")},{value:1<<2,label:c("Tuesday")},{value:1<<3,label:c("Wednesday")},{value:1<<4,label:c("Thursday")},{value:1<<5,label:c("Friday")},{value:1<<6,label:c("Saturday")}],g=[{value:0,label:c("January")},{value:1,label:c("February")},{value:2,label:c("March")},{value:3,label:c("April")},{value:4,label:c("Mai")},{value
:5,label:c("June")},{value:6,label:c("July")},{value:7,label:c("August")},{value:8,label:c("September")},{value:9,label:c("Oktober")},{value:10,label:c("November")},{value:11,label:c("Dezember")}];"use strict";function h(a){return{selector:"[name=day"+a+"]",converter:function(b,c,d,e){if(b==="ModelToView")return c&a;else return c?e.get(d)|a:e.get(d)-a}}}return d=Backbone.View.extend({RECURRENCE_NONE:0,RECURRENCE_DAILY:1,RECURRENCE_WEEKLY:2,RECURRENCE_MONTHLY:3,RECURRENCE_YEARLY:4,events:{"change [name=monthly_option]"
:"changeMonthlyOption","change [name=yearly_option]":"changeYearlyOption"},tagName:"div",className:"control-group recurrence",initialize:function(){var a=this;a.template=doT.template(b),a._modelBinder=new Backbone.ModelBinder,a.model.on("change:recurrence_type",_.bind(a.updateRecurrenceDetail,a))},render:function(){var b=this;b.$el.empty().append(b.template({uid:_.uniqueId("io_ox_calendar_edit_recurrence"),strings:e,weekDayList:f,monthList:g}));var c={day_in_month:"[name=day_in_month]",interval:"[name=interval]"
,month:"[name=month]",recurrence_start:{selector:"[name=recurrence_start]",converter:a.convertDate},until:{selector:"[name=until]",converter:a.convertDate},recurrence_type:[{selector:"[name=recurrence_type]",converter:a.numToString}]};return c.days=[],_.each(f,function(a){c.days.push(h(a.value))}),c.days.push({selector:"[name=days]"}),b._modelBinder.bind(b.model,b.el,c),b.updateRecurrenceDetail(),b},updateRecurrenceDetail:function(){var a=this;a.$(".recurrence_details").hide();switch(parseInt(a.model
.get("recurrence_type"),10)){case a.RECURRENCE_DAILY:a.model.unset("day_in_month"),a.model.has("interval")||a.model.set("interval",1),a.$(".recurrence_details.daily").show();break;case a.RECURRENCE_WEEKLY:a.model.has("interval")||a.model.set("interval",1),a.model.has("days")||a.model.set("days",2),a.$(".recurrence_details.weekly").show();break;case a.RECURRENCE_MONTHLY:console.log("ok monthly"),a.model.unset("month"),a.$(".recurrence_details.monthly").show(),a.model.has("day_in_month")||a.model.set
("day_in_month",1),a.model.has("interval")||a.model.set("interval",1),a.model.has("day_in_month")&&a.model.has("days")&&a.model.has("interval")?(console.log("chck option one"),a.model.set("interval",a.model.get("interval")),a.$("input[name=monthly_option][value=two]").attr("checked","checked")):a.$("input[name=monthly_option][value=one]").attr("checked","checked");break;case a.RECURRENCE_YEARLY:a.model.set("interval",1),a.$(".recurrence_details.yearly").show(),a.model.has("day_in_month")&&a.model
.has("days")&&a.model.has("month")?a.$("input[name=yearly_option][value=two]").attr("checked","checked"):a.$("input[name=yearly_option][value=one]").attr("checked","checked");break;case a.RECURRENCE_NONE:a.model.unset("interval"),a.model.unset("days"),a.model.unset("day_in_month"),a.model.unset("until"),a.model.unset("recurrence_start"),a.model.unset("month");break;default:}},changeMonthlyOption:function(a){var b=this,c=a.target.value;c==="one"?b.model.unset("days"):b.model.has("days")||b.model.set
("days",2),console.log("change monthly option")},changeYearlyOption:function(a){var b=this;console.log("change yearly option"),b.model.has("day_in_month")||b.model.set("day_in_month",1),b.model.has("month")||b.model.set("month",0),b.model.has("days")||b.model.set("days",2);var c=a.target.value;c==="one"&&b.model.unset("days")}}),d})