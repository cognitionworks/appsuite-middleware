define("io.ox/contacts/test",["io.ox/core/extensions","io.ox/contacts/main","io.ox/contacts/api"],function(a,b,c){var d={first_name:"Georg",last_name:"Tester",email1:"tester@test.de",cellular_telephone1:"0815123456789"},e=5e3;"use strict";function f(){var a=function(){return a.value};return a.value=!1,a.yep=function(){a.value=!0},a}a.point("test/suite").extend({id:"contacts-create",index:100,test:function(a){a.describe("Contact create",function(){var g,h,i,k,l,m,n,o,p,q,r=null;a.it("opens contact app "
,function(){var c=new f;a.waitsFor(c,"Could not load app",e),b.getApp().launch().done(function(){r=this,r.folder.setDefault().done(function(){c.yep(),a.expect(r).toBeTruthy()})})}),a.waitsFor(function(){l=$(".window-toolbar a[data-action='create']");if(l[0])return!0},"waits",e),a.it("looks for create button and hits ",function(){a.expect(l[0]).toBeTruthy(),l.trigger("click")}),a.waitsFor(function(){n=$(".io-ox-dialog-popup");if(n[0])return!0},"no form there",e),a.it("looks for the form and autofills "
,function(){var b;for(b in d)n.find("input[data-property='"+b+"']").val(d[b]).trigger("change");a.expect(n[0]).toBeTruthy()}),a.it("checks for alert div ",function(){o=$('[data-property="email1"]'),a.waitsFor(function(){if(o[0])return!0}),a.runs(function(){o.val("wrong_mail").trigger("change")}),a.waitsFor(function(){p=n.find(".alert");if(p[0])return!0}),a.runs(function(){a.expect(p).toBeTruthy()})}),a.it("corrects the value and skips the alert",function(){a.runs(function(){o.val("tester@test.de"
).trigger("change")}),a.runs(function(){q=p.find("a.close"),a.expect(q).toBeTruthy(),q.trigger("click")})}),a.it("looks for the save button and hits",function(){m=n.find(".btn.btn-primary"),m.trigger("click"),a.expect(m[0]).toBeTruthy()}),a.it("looks for the saved item and compares incl. autogenerated displayname",function(){a.runs(function(){var b=this;b.ready=!1,c.on("created",function(a,c){c&&(h=c.id,i=c.folder,b.ready=!0)}),a.waitsFor(function(){return this.ready},"catches the id",e)}),a.runs
(function(){c.get({id:h,folder_id:i}).done(function(a){k=a}),a.waitsFor(function(){if(k)return!0},"looks for the object",e),a.runs(function(){a.expect(k.first_name).toEqual(d.first_name),a.expect(k.last_name).toEqual(d.last_name),a.expect(k.display_name).toEqual("Tester, Georg"),a.expect(k.email1).toEqual(d.email1),a.expect(k.cellular_telephone1).toEqual(d.cellular_telephone1)})})}),a.it("looks for the created item / selects and deletes",function(){var b,c,d=i+"."+h,f=r.getGrid();a.waitsFor(function(
){if(f.contains(d))return f.selection.set({folder_id:i,id:h}),!0;else return!1},"looks for the list",e),a.waitsFor(function(){b=$('table[data-obj-id="'+d+'"] .io-ox-inline-links a[data-action="delete"]');if(b[0])return!0},"looks for delete button",e),a.runs(function(){b.trigger("click")}),a.waitsFor(function(){c=$('.io-ox-dialog-popup .btn[data-action="delete"]');if(c[0])return!0},"delete dialog to be there",e),a.runs(function(){a.expect(c).toBeTruthy()}),a.runs(function(){c.trigger("click"),r=g=
h=i=k=l=m=n=o=p=q=null})})})}})})