define("io.ox/contacts/create-view",["io.ox/core/extensions","gettext!io.ox/contacts/contacts","io.ox/contacts/util","io.ox/contacts/api","io.ox/core/tk/view","io.ox/core/tk/model"],function(a,b,c,d,e){var f=function(a){var c=$("<a>").attr({"data-action":"save",href:"#"}).addClass("btn btn-primary").text(b("Save")).on("click",function(){a.saveForm()});return c},g=function(a){var b=a.createPicUpload({wrap:!1,label:!1,charset:"UTF-8",enctype:"multipart/form-data",id:"contactUploadImage",method:"POST"
,formname:"contactUploadImage",name:"file",target:"hiddenframePicture"});function c(a){console.log("triggered");var b=a.target.files,c=new FileReader;c.onload=function(a){return function(a){$(".create-contact .picture").css("background-image","url("+a.target.result+")")}}(b[0]),c.readAsDataURL(b[0])}return b.find("input").on("change",c),b},h=function(){function a(){$('input[type="file"]').trigger("click")}var b=$("<div>").addClass("picture").css("background-image","url("+ox.base+"/apps/themes/default/dummypicture.png)"
);return b.on("click",a),b},i=$("<div>",{id:"myGrowl"}).addClass("jGrowl").css({position:"absolute",right:"0",top:"0"}),j=e.extend({draw:function(a){var d=this,e=["first_name","last_name","display_name","email1","cellular_telephone1"],f=d.createSection(),i=d.createSectionTitle({text:b("Add new contact")}),j=function(){console.log("update displayname"),d.getModel().set("display_name",c.getFullName(d.getModel().get()))};return this.getModel().on("change:title change:first_name change:last_name",j),
f.addClass("formheader").append(h(),g(d)),d.node.append(i),d.node.append(f),_.each(e,function(a){var c=_.uniqueId("c"),e=d.createSectionGroup(),f=d.getModel(),g=f.schema.getFieldLabel(a),h=f.schema.getFieldType(a),i;switch(h){case"string":i=d.createTextField({property:a,id:c,classes:"form-vertical"});break;case"pastDate":i=d.createDateField({property:a,id:c,classes:"form-vertical"});break;default:i=d.createTextField({property:a,id:c,classes:"form-vertical"})}e.append(d.createLabel({id:c,text:b(g)
}),i),d.node.append(e)}),this.getModel().on("error:invalid",function(a,b){console.log("error validation"),console.log(arguments),$("#myGrowl").jGrowl(b.message,{header:"Make an educated guess!",sticky:!1})}),d},drawButtons:function(){var a=this,b=f(a);return b},saveForm:function(){console.log("saveForm -> save",this),this.getModel().save()}});return"use strict",j})