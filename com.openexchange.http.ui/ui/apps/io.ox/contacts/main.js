define("io.ox/contacts/main",["io.ox/contacts/util","io.ox/contacts/api","io.ox/core/tk/vgrid","io.ox/help/hints","io.ox/contacts/view-detail","io.ox/core/config","io.ox/core/extensions","io.ox/core/commons","less!io.ox/contacts/style.css"],function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=ox.ui.createApp({name:"io.ox/contacts"}),o=330,p="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");return"use strict",n.setLauncher(function(){var d,f,g;i=ox.ui.createWindow({name:"io.ox/contacts",title:"Global Address Book",titleWidth
:o+27+"px",toolbar:!0,search:!0}),n.setWindow(i),k=$("<div>").addClass("leftside border-left border-right").css({left:38+"px",width:o-40+"px",overflow:"auto"}).appendTo(i.nodes.main),h.addFolderView(n,{width:o,type:"contacts",view:"FolderList"}),l=$("<div>").addClass("atb contact-grid-index border-right").css({left:"0px",width:"35px"}).appendTo(i.nodes.main),m=$("<div>").css({left:o+"px",overflow:"auto"}).addClass("rightside default-content-padding").appendTo(i.nodes.main).scrollable(),j=new c(k)
,j.addTemplate({build:function(){var a,b,c;return this.addClass("contact").append(a=$("<div>").addClass("fullname")).append(b=$("<div>")).append(c=$("<div>").addClass("bright-text")),{name:a,job:c,email:b}},set:function(b,c){b.mark_as_distributionlist===!0?(c.name.text(b.display_name||""),c.email.text(""),c.job.text("Distribution list")):(c.name.text(a.getFullName(b)),c.email.text(a.getMail(b)),c.job.text(a.getJob(b)))}}),j.addLabelTemplate({build:function(){},set:function(a){var b=a.last_name||a
.display_name||"#";this.text(b.substr(0,1).toUpperCase())}}),j.requiresLabel=function(a,b,c){var d=b.last_name||b.display_name||"#",e=d.substr(0,1).toUpperCase();return a===0||e!==c?e:!1},h.wireGridAndAPI(j,b),h.wireGridAndSearch(j,i,b),d=function(a){m.busy(!0),b.get(b.reduce(a)).done(_.lfo(f)).fail(_.lfo(g,a))},f=function(a){m.idle().empty().append(e.draw(a))},g=function(a){m.idle().empty().append($.fail("Oops, couldn't load contact data.",function(){d(a)}))};function q(a,b){var c=$("<div>").addClass
("thumb-index border-bottom"+(b?"":" thumb-index-disabled")).text(a);return b&&c.on("click",{text:a},j.scrollToLabelText),c}j.on("change:ids",function(){var a;l.empty(),a=j.getLabels().textIndex||{},_(p).each(function(b){l.append(q(b,b in a))})}),h.wireGridAndSelectionChange(j,"io.ox/contacts",d,m),h.wireGridAndWindow(j,i),h.wireFirstRefresh(n,b),h.wireGridAndRefresh(j,b,i),n.getGrid=function(){return j},h.addFolderSupport(n,j,"contacts","6").done(h.showWindow(i,j))}),{getApp:n.getInstance}})