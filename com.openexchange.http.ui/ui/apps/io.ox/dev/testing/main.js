define("io.ox/dev/testing/main",["io.ox/dev/testing/jasmine","io.ox/core/extensions"],function(a,b){var c,d,e=ox.ui.createApp({name:"io.ox/dev/testing",title:"Unit Tests"});"use strict";function f(a){if(typeof a=="string")return a.replace(/\r/g,"\\r").replace(/\n/g,"\\n");else return a}function g(){var a=_(arguments).map(function(a){return f(a)});console&&console.error&&(_.browser.IE?console.error(a.join(" ")):console.error.apply(console,a))}return e.setLauncher(function(){var h,i,j,k,l,m;c=ox.ui
.createWindow({title:"Jasmine Tests"}),e.setWindow(c),a.jasmine.WaitsForBlock.TIMEOUT_INCREMENT=100,h=_.url.hash("suites"),i="#app=io.ox/dev/testing",j=function(a){a.preventDefault(),location.href=i+(a.data.id!=="all"?"&suites="+a.data.id:""),location.reload()},k=function(a,b){a.append($("<a>",{href:"#"}).on("click",{id:b},j).text(b)).append($.txt(" "))},l=function(){b.point("test/suite").each(function(b){(_(h).indexOf("ALL")>-1||_(h).indexOf(b.id)>-1)&&b.test(a)}),d.execute()},m=function(){var b
,e;d=a.jasmine.getEnv(),b=0,e=0,d.addReporter({reportRunnerStarting:function(a){c.nodes.main.busy().find(".results").empty(),b=e=0,_(a.suites()).each(function(a){c.nodes.main.find(".results").append($("<div>").attr("data-suite-id",a.id).append($("<h1>").css("margin","1em 0 0.5em 0").addClass("clear-title").text(String(a.description))).append($("<ol>").append(_(a.specs()).inject(function(a,b){return a.add($("<li>").attr("data-spec-id",b.id).text(String(b.description)))},$()))))})},reportRunnerResults
:function(){c.nodes.main.idle(),c.show(),c.nodes.main.find(".summary").empty().html("<b>Summary:</b> Total number of tests: <b>"+b+"</b> Failed: <b>"+e+"</b>").css("color",e>0?"#a00":"#070"),location.hash="#app=io.ox/dev/testing"},reportSpecResults:function(a){var d=c.nodes.main.find("[data-suite-id="+a.suite.id+"] [data-spec-id="+a.id+"]"),h=a.results();h.failedCount===0?(d.css("color","#070"),b++):(d.css({color:"#a00",fontWeight:"bold"}),_(h.items_).each(function(a){a.passed()||($("<div>").text
(f(a+"")).appendTo(d),g("Actual",a.actual,"Expected",a.expected))}),e++)}})},c.nodes.main.addClass("io-ox-testing selectable-text").css({overflow:"auto",padding:"1.5em 13px 1.5em 13px"}).append($("<div>").addClass("header")).append($("<div>").addClass("summary").css("lineHeight","2em").text(" ")).append($("<div>").addClass("results")),c.on("open",function(){b.loadPlugins({name:"tests",prefix:"",suffix:"test"}).done(function(){var a=$("<div>").append($("<b>").text("Available suites: ")).appendTo(c
.nodes.main.find(".header"));h=h?String(h).split(/,/):[],_(["ALL"].concat(b.point("test/suite").chain().sortBy(function(a){return a.id}).map(function(a){return a.id}).value())).each(function(b,c,d){k(a,b),c<d.length-1&&a.append($.txt(" – "))}),m(),l()})}),c.show()}),{getApp:e.getInstance}})