define("io.ox/linkedIn/view-detail",["io.ox/core/extensions","io.ox/core/tk/dialogs","io.ox/core/http","less!io.ox/linkedIn/style.css"],function(a,b,c){var d=a.point("linkedIn/details/actions"),e=a.point("linkedIn/details/renderer");"use strict";function f(){alert("TODO")}function g(a){var b,c=$("<div>").addClass("linkedIn").css({overflow:"auto"}),f=$("<div>").addClass("details").appendTo(c),g=$("<table><tr><td class='t10'></td><td class='t11'></td></tr><tr><td class='r2' colspan='2'></td></tr><table>"
).appendTo(f),h=g.find(".t10"),i=g.find(".t11"),j=g.find(".r2");return h.append($("<img>",{src:a.pictureUrl||ox.base+"/apps/themes/default/dummypicture.png",alt:a.firstName+" "+a.lastName}).css({margin:"0 5px 0 0"})),i.append($("<div>").addClass("name").text(a.firstName+" "+a.lastName)).append($("<div>").addClass("headline").text(a.headline)),b=$("<div>").addClass("actions").appendTo(c),d.each(function(a){b.append($("<a>",{href:"#"}).text(a.label).click(function(b){b.preventDefault(),a.action()})
)}),e.each(function(b){c.append(b.draw({data:a,win:c}))}),c}return d.extend({id:"linkedin/details/connect",label:"Connect",action:f,index:100}),d.extend({id:"linkedin/details/compose",label:"Write a message",action:f,index:200}),e.extend({id:"linkein/details/renderer/experience",draw:function(a){var b,c,d,e=a.data,f=a.win,g=$("<div>").addClass("pastEngagements extension");return e.positions&&e.positions.values&&e.positions.values.length!==0&&(b=[],_(e.positions.values).each(function(a){var c,d=$("<div>"
).addClass("position").appendTo(g);a.isCurrent?d.addClass("current"):(d.hide(),b.push(d)),a.startDate&&a.startDate.year&&(c=a.startDate.year,a.endDate&&a.endDate.year?c+=" - "+a.endDate.year:a.isCurrent&&(c+=" - Present"),$("<span>").text(c).appendTo(d).addClass("timeSpent")),a.title&&$("<span>").appendTo(d).text(a.title).addClass("title"),a.company&&a.company.name&&$("<div>").text(a.company.name).appendTo(d).addClass("companyName")}),b.length!==0&&(c=!1,d=$("<a>",{href:"#"}).text("More...").click
(function(a){a.preventDefault(),c=!c,c?(d.text("Show less"),_(b).invoke("show"),f.animate({scrollTop:_(b).first().offset().top-50},500)):(d.text("More..."),_(b).invoke("hide"))}).appendTo(g))),g},index:100}),e.extend({id:"linkein/details/renderer/relations",draw:function(a){var d,e=a.data,f=$("<div>").addClass("relations extension");return e.relationToViewer&&e.relationToViewer.connections&&e.relationToViewer.connections.values&&e.relationToViewer.connections.values!==0&&($("<div>").css({marginBottom
:"5px",fontWeight:"bold"}).text("Connections you share with "+e.firstName+" "+e.lastName).appendTo(f),d=function(a){var b=$(this).data("object-data");a.append(g(b));var d=$("<div/>").css("min-height","100px").busy().appendTo(a);c.GET({module:"integrations/linkedin/portal",params:{action:"fullProfile",id:b.id}}).done(function(b){d.idle(),a.empty().append(g(b))})},(new b.SidePopup).delegate(f,".linkedin-profile-picture",d),_(e.relationToViewer.connections.values).each(function(a){var b;a.person&&a.
person.pictureUrl?b=a.person.pictureUrl:b=ox.base+"/apps/themes/default/dummypicture.png",$("<img>").addClass("linkedin-profile-picture").css({margin:"0 5px 0 0",cursor:"pointer"}).attr("src",b).attr("alt",a.person.firstName+" "+a.person.lastName).data("object-data",a.person).appendTo(f)})),f},index:200}),{draw:g}})