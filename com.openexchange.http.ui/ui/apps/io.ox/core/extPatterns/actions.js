define("io.ox/core/extPatterns/actions",["io.ox/core/extensions","io.ox/core/collection"],function(a){var b=function(a){return function(b){return b.collection.has.apply(b.collection,a.split(/ /))}},c=function(a){return a.collection.has("one")},d=function(d,e){var f=_.extend({requires:c},e);f.id=f.id||_(d.split(/\//)).last(),_.isString(f.requires)&&(f.requires=b(f.requires)),a.point(d).extend(f)},e=function(b,c,d,e){var f=new $.Deferred;return c.getProperties().done(function(){var g=a.point(b.ref)
.map(function(b){var f=$.Deferred();return b.isEnabled&&!b.isEnabled.apply(b,e)?f.resolve({link:b,state:!1}):$.when.apply($,a.point(b.ref).map(function(a){var b=_.isFunction(a.requires)?a.requires({collection:c,context:d}):!0;return b.promise||(b=$.Deferred().resolve(b)),b}).value()).done(function(){var a=_(arguments).reduce(function(a,b){return a&&b===!0},!0);f.resolve({link:b,state:a})}),f});$.when.apply($,g.value()).done(function(){f.resolve(_.chain(arguments).filter(function(a){return a.state
}).pluck("link").value()),g=null})}),f},f=function(b,c,d){var e=a.point(b),f=d?d.data||d:{};e.invoke("action",c,f,d),e.invoke("multiple",c,_.isArray(f)?f:[f],d)};return"use strict",{Action:d,invoke:f,extPatterns:{applyCollection:e}}})