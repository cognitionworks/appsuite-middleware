define("io.ox/core/tk/text-editor",[],function(){var a=$.original.val;"use strict";function b(b){var c,d,e,f,g,h,i;b=$(b),c=$.when(),d=_.debounce(function(){var a=b.parent(),c=a.width(),d=a.height();a.find("table.mceLayout").css({width:c+"px",height:d+"px"})},100),e=function(a){return String(a||"").replace(/^[^\S\n]+/,"").replace(/^\n{3,}/,"").replace(/\s+$/,"")},f=function(c){a.call(b,String(c||""))},g=function(){a.call(b,"")},h=function(){return e(a.call(b))},this.getMode=function(){return"text"
},this.done=function(a){return c.done(a),c},this.focus=function(){b.focus()},this.clear=g,this.getContent=h,this.getPlainText=h,this.setContent=f,this.setPlainText=f,this.paste=$.noop,this.scrollTop=function(a){if(a===undefined)return b.scrollTop();else a==="top"?b.scrollTop(0):a==="bottom"&&b.scrollTop(b.get(0).scrollHeight)},this.appendContent=function(a){var b=this.getContent();this.setContent(b+"\n\n"+a)},this.replaceParagraph=function(a,b){var c,d,e=this.getContent();if((c=e.indexOf(a))>-1)return d=
this.scrollTop(),this.setContent(e.substr(0,c)+(b||"")+e.substr(c+a.length)),this.scrollTop(d),!0;else return!1},i=function(){var a=!1;return _.debounce(function(){var c=Math.max(10,b.outerWidth()-12-750);b.css("paddingRight",c+"px"),b.parents(".window-content").find(".editor-print-margin").css("right",Math.max(0,c-10)+"px").show(),b.css("display",(a=!a)?"block":"")},100)}(),this.handleShow=function(){b.removeAttr("disabled").idle().show().next().hide(),i(),$(window).on("resize",i)},this.handleHide=
function(){$(window).off("resize",i)},this.destroy=function(){this.handleHide(),this.setContent(""),b=c=null}}return b})