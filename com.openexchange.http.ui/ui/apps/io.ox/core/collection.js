define("io.ox/core/collection",["io.ox/core/config","io.ox/core/api/folder"],function(a,b){var c=0,d=function(d,e,f){var g=b.derive.bits(d,f);if(g===0)return!1;else if(g===1)return c=c||a.get("identifier"),e===c;else return!0},e=function(a){if(_.isObject(a.folder)&&_.isFunction(a.folder.get))return a.folder.get();else if("folder_id"in a||"folder"in a)return a.folder_id||a.folder;else return undefined},f=function(a){var c=a.length||0,f={read:!0,modify:!0,"delete":!0,create:!0,none:c===0,some:c>0,one
:c===1,multiple:c>1},g=_.chain(a).map(e).filter(function(a){return a!==null&&a!==undefined}).value();return f.toplevel=_(a).reduce(function(a,b){return a&&"folder_id"in b&&!("filename"in b)},!0),b.get({folder:g}).pipe(function(b){var g=0,h=null,i=null;for(;g<c;g++){h=a[g];if(i=b[e(h)])f.read=f.read&&d(i,h.created_by,7),f.modify=f.modify&&d(i,h.created_by,14),f["delete"]=f["delete"]&&d(i,h.created_by,21),f.create=f.create&&(i.own_rights&127)>=2;else{f.unknown=!0,f.read=f.modify=f["delete"]=f.create=!1
;break}}return f})};"use strict";function g(a){var b=_.compact([].concat(a)),c={},d=c;this.getProperties=function(){return f(b).done(function(a){d=a})},this.has=function(){return d===c&&console.error("Using Collection.has before properties are resolved!",a,arguments),_(arguments).inject(function(a,b){return a&&d[b]===!0},!0)}}return g})