define("io.ox/mail/write/test/html_reply",["io.ox/mail/main","io.ox/mail/api","io.ox/core/api/user","io.ox/core/config","io.ox/core/extensions"],function(a,b,c,d,e){var f=ox.base+"/apps/io.ox/mail/write/test",g=5e3;"use strict";function h(){var a=function(){return a.value};return a.value=!1,a.yep=function(){a.value=!0},a}e.point("test/suite").extend({id:"mail-reply-html",index:100,test:function(b){b.describe("Reply email",function(){var e=null,f=null,i=null;b.it("opens mailer",function(){var c=new 
h;b.waitsFor(c,"compose dialog",g),a.getApp().launch().done(function(){e=this,c.yep(),b.expect(e).toBeDefined()})}),b.waitsFor(function(){var a=$(".leftside .mail");if(a[0])return!0},"no mails there",g),b.it("select first mail",function(){var a=$(".leftside .mail").eq(0);console.log(a),a.trigger("click")}),b.waitsFor(function(){var a=$(".rightside .io-ox-action-link");if(a[0])return!0},"no action links there",g),b.it("reply mail",function(){$(".rightside .io-ox-action-link[data-action=reply]").trigger
("click")}),b.waitsFor(function(){if($(".recipient-list .io-ox-mail-write-contact").length===1)return!0},"recipent list is empty",g),b.it("remove original recipent",function(){$(".recipient-list .io-ox-mail-write-contact .remove").trigger("click")}),b.it("add recipent",function(){var a,e=new h;b.waitsFor(e,"adding recipent",g),a=d.get("identifier"),c.get({id:a}).done(function(a){e.yep(),$("input[data-type=to]").val('"'+a.display_name+'" '+a.email1).focus().trigger($.Event("keyup",{which:13}))})})
,b.waitsFor(function(){if($(".recipient-list .io-ox-mail-write-contact").length===1)return!0},"recipent list is empty",g),b.it('check for "Re"',function(){var a=$(".subject-wrapper input:text").val().substring(0,3);b.expect(a).toEqual("Re:")}),b.it("change editor to html format",function(){b.waitsFor(function(){var a=$(".editor-inner-container .text-editor");if(a[0])return!0},"no editor there",g),$(".change-format a:contains('HTML')").trigger("click")}),b.it("send the reply",function(){b.waitsFor
(function(){var a=$(".editor-inner-container .mceEditor");if(a[0])return!0},"no editor there",g),$(".sendbutton-wrapper .btn-primary:first").trigger("click")})})}})})