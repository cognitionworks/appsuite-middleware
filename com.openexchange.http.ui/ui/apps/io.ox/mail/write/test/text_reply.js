define("io.ox/mail/write/test/text_reply",["io.ox/mail/main","io.ox/mail/api","io.ox/core/api/user","io.ox/core/config","io.ox/core/extensions"],function(a,b,c,d,e){var f=ox.base+"/apps/io.ox/mail/write/test",g=5e3;"use strict";function h(){var a=function(){return a.value};return a.value=!1,a.yep=function(){a.value=!0},a}e.point("test/suite").extend({id:"mail-reply-text",index:100,test:function(b){b.describe("Reply email",function(){var e=null,f=null,i=null;b.it("opens mailer",function(){var c=new 
h;b.waitsFor(c,"compose dialog",g),a.getApp().launch().done(function(){var a=this;c.yep(),b.expect(a).toBeDefined()})}),b.it("select first mail",function(){var a=$(".leftside .mail").eq(0);a.trigger("click")}),b.waitsFor(function(){var a=$(".rightside .io-ox-action-link");if(a[0])return!0},"no editor there",g),b.it("reply mail",function(){$(".rightside .io-ox-action-link[data-action=reply]").trigger("click")}),b.waitsFor(function(){if($(".recipient-list .io-ox-mail-write-contact").length===1)return!0
},"recipent list is empty",g),b.it("remove original recipent",function(){$(".recipient-list .io-ox-mail-write-contact .remove").trigger("click")}),b.it("add recipent",function(){var a,e=new h;b.waitsFor(e,"adding recipent",g),a=d.get("identifier"),c.get({id:a}).done(function(a){e.yep(),$("input[data-type=to]").val('"'+a.display_name+'" '+a.email1).focus().trigger($.Event("keyup",{which:13}))})}),b.waitsFor(function(){if($(".recipient-list .io-ox-mail-write-contact").length===1)return!0},"recipent list is empty"
,g),b.waitsFor(function(){var a=$(".editor-outer-container");if(a[0])return!0},"no editor there",g),b.it("change editor to text format",function(){$(".change-format a:contains('Text')").trigger("click")}),b.it("close the editor",function(){$(".window-controls .close").trigger("click")}),b.waitsFor(function(){var a=$(".modal-footer");if(a[0])return!0},"no popup there",g),b.it("lose changes",function(){$(".modal-footer .btn-primary").trigger("click")})})}})})