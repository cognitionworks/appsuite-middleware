define("io.ox/mail/view-grid-template",["io.ox/mail/util","io.ox/mail/api","io.ox/core/tk/vgrid","io.ox/core/api/account","less!io.ox/mail/style.css"],function(a,b,c,d){var e={main:{build:function(){var a,b,c,d,e,f,g;return this.addClass("mail").append($("<div>").append(b=$("<span>").addClass("date"),a=$("<div>").addClass("from")),$("<div>").append(f=$("<div>").addClass("thread-size"),g=$("<div>").addClass("flag").text("Â "),e=$("<span>").addClass("attachment"),c=$("<span>").addClass("priority"),$
("<div>").addClass("subject").append($("<i>").addClass("icon-envelope")).append(d=$("<span>")))),{from:a,date:b,priority:c,subject:d,attachment:e,threadSize:f,flag:g}},set:function(b,c,e){c.priority.empty().append(a.getPriority(b)),c.subject.text(_.prewrap($.trim(b.subject))),!b.threadSize||b.threadSize<=1?c.threadSize.text("").css("display","none"):c.threadSize.text(b.threadSize).css("display",""),c.from.empty().append(a.getFrom(d.is(b.folder_id,"sent")?b.to:b.from,!0)),c.date.text(a.getTime(b.received_date
)),c.attachment.css("display",b.attachment?"":"none"),c.flag.get(0).className="flag flag_"+(b.color_label||0),a.isUnread(b)&&this.addClass("unread"),a.byMyself(b)&&this.addClass("me"),a.isDeleted(b)&&this.addClass("deleted"),this.attr("data-index",e)}},thread:{build:function(){},set:function(c,d,e,f){var g=this.removeClass("vgrid-label").addClass("thread-summary").empty(),h=b.getThread(f),i=b.getThreadOrder(f);return b.getList(h).done(function(b){b=i==="desc"?b.slice(1):b.slice(0,-1),_(b).each(function(
b){var c=b.folder_id+"."+b.id;g.append($("<div>").addClass("thread-summary-item selectable").addClass(a.isUnread(b)?"unread":undefined).attr("data-obj-id",c).append($("<div>").addClass("date").text(a.getTime(b.received_date)),$("<div>").append(a.getFrom(b.from).removeClass("person"))))})})}},drawSimpleGrid:function(a){var b=new c.Template,d=$("<div>");return b.add(e.main),_(a).each(function(a,c){var e=b.getClone();e.update(a,c),e.appendTo(d).node.css("position","relative").data("object-data",a).addClass
("hover")}),d}};return"use strict",e})