define("io.ox/settings/accounts/email/test",["io.ox/core/extensions","io.ox/core/api/account","io.ox/settings/main"],function(a,b,c){var d=5e3,e={primary_address:"oxtestermail@googlemail.com",mail_protocol:"imap",mail_port:"993",mail_server:"imap.googlemail.com",transport_protocol:"smtp",transport_port:"465",transport_server:"smtp.googlemail.com",login:"oxtestermail@googlemail.com",name:"Neuer Account",personal:"oxtestermail",unified_inbox_enabled:!1,mail_secure:!0,password:"supersicher0815",transport_secure
:!0,pop3_storage:"mailaccount",spam_handler:"NoSpamHandler"},f={name:"Neuer Account",primary_address:"oxtestermail@googlemail.com",personal:"oxtestermail",unified_inbox_enabled:!1,mail_protocol:"imap",mail_secure:!0,mail_server:"imap.googlemail.com",mail_port:"993",login:"oxtestermail@googlemail.com",password:"supersicher0815",transport_secure:!0,transport_server:"smtp.googlemail.com",transport_port:"465",transport_credentials:!1},g={email:"oxtestermail@googlemail.com",password:"supersicher0815"}
;"use strict";function h(){var a=function(){return a.value};return a.value=!1,a.yep=function(){a.value=!0},a}a.point("test/suite").extend({id:"email-account-create-api",index:100,test:function(a){a.describe("Creates a new Emailaccount via api",function(){var c,f;a.it("creates a new account",function(){b.create(e)}),a.it("gets the id of the created account",function(){a.runs(function(){var e=this;e.ready=!1,b.on("account_created",function(a,b){b&&(c=b.id,e.ready=!0)}),a.waitsFor(function(){return this
.ready},"catches the id",d)})}),a.it("modifies the account name",function(){a.runs(function(){var e=this;e.ready=!1,b.get(c).done(function(a){f=a,f.name="Ein Account changed",e.ready=!0}),a.waitsFor(function(){return this.ready},"update",d)})}),a.it("deletes the created account",function(){b.remove([c])})})}}),a.point("test/suite").extend({id:"email-account-create-ui",index:100,test:function(a){a.describe("Creates a new Emailaccount via ui",function(){var e,f,i,k,l,m,n,o,p,q,r=null;a.it("opens settings app "
,function(){var f=new h;b.on("account_created",function(a,b){b&&(n=b.id)}),a.waitsFor(f,"Could not load app",d),c.getApp().launch().done(function(){r=this,f.yep(),a.waitsFor(function(){e=$('[data-obj-id="io.ox/settings/accounts"]');if(e[0])return e.trigger("click"),!0},"trigger",d),a.expect(r).toBeTruthy()})}),a.it("hits the add button",function(){a.waitsFor(function(){f=$('[data-action="add"]');if(f[0])return!0},"looks for add button",d),a.runs(function(){f.triggerHandler("click")})}),a.it("looks for the autoconf form and the add button"
,function(){a.waitsFor(function(){l=$(".io-ox-dialog-popup"),i=$(l).find("button.btn-primary");if(l[0]&&i[0])return!0},"looks for dialog",d)}),a.it("fills the form",function(){$(l).find("input").val(g.email)}),a.it("hits the add button",function(){a.runs(function(){i.trigger("click")})}),a.it("looks for the password form and the add button",function(){a.waitsFor(function(){m=$(".io-ox-dialog-popup"),o=$(m).find('input[type="password"]'),k=$(m).find("button.btn-primary");if(m[0]&&k[0]&&o[0])return!0
},"looks for dialog",d)}),a.it("fills the form",function(){$(m).find("input").val(g.password)}),a.it("hits the add button",function(){a.runs(function(){k.trigger("click")})}),a.it("looks for the success message and the close button",function(){a.waitsFor(function(){p=$(".io-ox-dialog-popup"),q=$(p).find("button.btn.closebutton");if(q[0])return!0},"looks for dialog",1e4)}),a.it("hits the close button",function(){a.runs(function(){q.trigger("click")})}),a.it("gets the id of the created account and deletes"
,function(){a.runs(function(){b.remove([n])})})})}}),a.point("test/suite").extend({id:"email-autoconfig",index:100,test:function(a){a.describe("Tests the mail-autoconfig api",function(){a.it("tests the autoconfig api",function(){a.runs(function(){var c=this;c.ready=!1,b.autoconfig(g).done(function(a){console.log(a),c.ready=!0}).fail(function(){console.log("no configdata recived")}),a.waitsFor(function(){return this.ready},"response from autoconfig arrived",d)})})})}}),a.point("test/suite").extend
({id:"email-validate",index:100,test:function(a){a.describe("Tests the validate functions of the api",function(){a.it("tests the validate functions",function(){a.runs(function(){var c=this;c.ready=!1,b.validate(f).done(function(a){a===!0&&(c.ready=!0)}).fail(function(){console.log("no configdata recived")}),a.waitsFor(function(){return this.ready},"response from autoconfig arrived",d)})})})}})})