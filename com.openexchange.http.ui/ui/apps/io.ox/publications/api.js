define("io.ox/publications/api",["io.ox/core/http","io.ox/core/api/folder","io.ox/core/cache"],function(a,b){var c={all:{},get:{}},d={get:function(b){if(!c.get[b])return a.GET({module:"publications",params:{action:"get",id:b}}).pipe(function(a){return c.get[b]=a});else return $.Deferred().resolve(c.get[b])},getAll:function(b){return a.GET({module:"publications",params:_.extend({action:"all"},{folderId:b})}).pipe(function(a){return $.when.apply($,_(a).map(function(a){return d.get(a[0])}))}).pipe(function(
){return $.makeArray(arguments)})},publishFolder:function(c,e){return b.get({folder:c}).pipe(function(c){e=e||{};var f;return c.module==="infostore"?f={target:"com.openexchange.publish.microformats.infostore.online",entityModule:"infostore",entity:{folder:c.id},"com.openexchange.publish.microformats.infostore.online":{siteName:e.siteName||String(_.now()),template:e.template||"album.tmpl","protected":!0}}:console.error("No options defined for this folder type",c.module,c),a.PUT({module:"publications"
,params:{action:"new"},data:f}).done(function(){b.folderCache.remove(c.id),b.trigger("change change:"+c.id,c.id,c)}).pipe(function(a){return d.get(a)})})}};return"use strict",d})