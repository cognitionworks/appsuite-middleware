define("plugins/portal/mail/register",["io.ox/core/extensions","io.ox/core/extPatterns/links"],function(a,b){"use strict",a.point("io.ox/portal/widget/mail/actions/compose").extend({id:"compose",action:function(){require(["io.ox/mail/write/main"],function(a){a.getApp().launch().done(function(){this.compose()})})}}),a.point("io.ox/portal/widget/mail/links/inline").extend(new b.Link({index:100,id:"compose",label:"Compose new email",ref:"io.ox/portal/widget/mail/actions/compose"})),a.point("io.ox/portal/widget/mail"
).extend(new b.InlineLinks({index:200,id:"inline-links",ref:"io.ox/portal/widget/mail/links/inline"})),a.point("io.ox/portal/widget").extend({id:"mail",index:300,load:function(){var a=new $.Deferred;return require(["io.ox/mail/api"],function(b){b.getAllThreads().done(function(c){b.getThreads(c.slice(0,5)).done(a.resolve).fail(a.reject)}).fail(a.reject)}),a},draw:function(b){var c=this;c.empty().addClass("io-ox-portal-mail").append($("<div>").addClass("clear-title").text("New emails")),a.point("io.ox/portal/widget/mail"
).invoke("draw",c);if(b.length===0)return c.append("<div><b>No mails at all!</b></div>"),$.when();else return require(["io.ox/core/tk/dialogs","io.ox/mail/view-grid-template"],function(a,d){d.drawSimpleGrid(b).appendTo(c),(new a.SidePopup(600)).delegate(c,".vgrid-cell",function(a){var b=$(this).data("object-data");a.parent().removeClass("default-content-padding"),require(["io.ox/mail/view-detail","io.ox/mail/api"],function(c,d){var e=d.getThread(b);d.get(e[0]).done(function(b){c.drawThread(a,e,b)
})})})})},post:function(a){var b=this;require(["io.ox/mail/api"],function(c){c.on("refresh.all",function(){a.load().done(_.bind(a.draw,b))})})}})})