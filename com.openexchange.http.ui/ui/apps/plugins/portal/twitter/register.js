define("plugins/portal/twitter/register",["io.ox/core/extensions","io.ox/oauth/proxy","less!plugins/portal/twitter/style.css"],function(a,b){var c=function(a,b){var c={};_(b.hashtags).each(function(a){var b=$("<a>",{href:"https://twitter.com/#!/search/%23"+a.text,target:"_blank"}).text("#"+a.text);c[a.indices[0]]={elem:b,indices:a.indices}}),_(b.urls).each(function(a){var b=$("<a>",{href:a.expanded_url,target:"_blank"}).text(a.display_url);c[a.indices[0]]={elem:b,indices:a.indices}}),_(b.user_mentions
).each(function(a){var b=$("<a>",{href:"https://twitter.com/#!/"+a.screen_name.text,target:"_blank"}).text("@"+a.screen_name);c[a.indices[0]]={elem:b,indices:a.indices}});var d=_(c).keys().sort(function(a,b){return a-b}),e=$("<div>"),f=0;return _(d).each(function(b){var d=c[b];e.append(a.substring(f,d.indices[0])).append(d.elem),f=d.indices[1]}),f<a.length&&e.append(a.substr(f,a.length)),e};"use strict",a.point("io.ox/portal/widget").extend({id:"twitter",index:140,load:function(){var a=b.request(
{api:"twitter",url:"https://api.twitter.com/1/statuses/home_timeline.json",params:{count:5,include_entities:!0}});return a.pipe(function(a){return a?JSON.parse(a):null})},draw:function(a){var b,d,e;if(!a)return this.remove(),$.Deferred().resolve();return b=this,b.append($("<div>").addClass("clear-title").text("Twitter")),d=0,e=$('<div class="twitter">').appendTo(b),_(a).each(function(a){var b="https://twitter.com/"+a.user.screen_name+"/status/"+a.id,d="https://twitter.com/"+a.user.screen_name;$('<div class="tweet">'
).append($("<a>",{href:b,target:"_blank"}).append($("<img>",{src:a.user.profile_image_url,"class":"profilePicture",alt:a.user.description}))).append($('<div class="text">').append($("<a>",{"class":"name",href:d,target:"_blank"}).text(a.user.name)).append("<br />").append(c(a.text,a.entities))).appendTo(e)}),$.Deferred().resolve()}})})