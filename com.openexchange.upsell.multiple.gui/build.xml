<project name="com.openexchange.upsell.multiple.gui" default="install" basedir=".">

    <description>
        Open-Xchange Upsell Multiple UI
    </description>

    <!-- Customizable values -->
    <property name="destdir" value=""/>
    <property name="prefix" value="/opt/open-xchange"/>
    <property name="guiprefix" value="/var/www/ox6" />

    <!-- Constants -->
	<property name="tmp.dir" value="tmp"/>
	    
	<property name="symlink_target_lang" value="${symlink_target_lang}"/>
	    
	
   	<property file="META-INF/MANIFEST.MF" />
	<property file="build.properties" />
    
    <!-- Install Constants -->
	<property name="guipluginsdir" value="${guiprefix}/plugins" />

	<property name="version" value="${Bundle-Version}"/>
	<property name="bundle.name" value="${Bundle-SymbolicName}.jar" />
	<property name="composite.name" value="open-xchange-upsell-multiple-gui-${version}" />

    <!-- Replacements -->
    <property name="conf.install.dir" value="${prefix}/etc/groupware"/>
    <property name="conf.install.copy.dir" location="${destdir}${conf.install.dir}"/>
    
	<!-- Compile -->
	<target name="prepare" />

	<target name="compile" depends="prepare" />

	<target name="jar" depends="prepare,compile" />
    
    <!-- Install -->
	<target name="installConfig">
		<copy todir="${destdir}/${prefix}/etc/groupware/settings/" overwrite="true">
			<fileset dir="conf" />
		</copy>
	</target>

	<target name="installGui">
		<mkdir dir="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}" />
		<copy todir="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}" overwrite="true">
			<fileset dir="gui">
			  		<exclude name="build.xml"/>
			</fileset>
		</copy>
		
		 <!-- Install symlinks -->
             <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_calendar/en_US" resource="${symlink_target_lang}" />
             <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_calendar/es_ES" resource="${symlink_target_lang}" />
             <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_calendar/fr_FR" resource="${symlink_target_lang}" />
             <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_calendar/jp_JP" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_calendar/nl_NL" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_calendar/pl_PL" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_calendar/sv_SV" resource="${symlink_target_lang}" />

		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_infostore/en_US" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_infostore/es_ES" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_infostore/fr_FR" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_infostore/jp_JP" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_infostore/nl_NL" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_infostore/pl_PL" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_infostore/sv_SV" resource="${symlink_target_lang}" />

		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_mobility/en_US" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_mobility/es_ES" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_mobility/fr_FR" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_mobility/jp_JP" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_mobility/nl_NL" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_mobility/pl_PL" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_mobility/sv_SV" resource="${symlink_target_lang}" />

		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_outlook/en_US" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_outlook/es_ES" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_outlook/fr_FR" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_outlook/jp_JP" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_outlook/nl_NL" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_outlook/pl_PL" resource="${symlink_target_lang}" />
		     <symlink link="${destdir}/${guipluginsdir}/${Bundle-SymbolicName}/templates/_outlook/sv_SV" resource="${symlink_target_lang}" />

	</target>

    <target name="install" depends="installConfig,installGui"/>

	<!-- Dist -->
	<target name="dist" depends="clean">
		<property name="dist-package" value="dist-package"/>
    	<delete dir="${dist-package}"/>
        <mkdir dir="${dist-package}/${composite.name}"/>
        <copy todir="${dist-package}/${composite.name}">
            <fileset dir=".">
                <exclude name="**${dist-package}/**"/>
                <exclude name="**debian/**"/>
                <exclude name="**CVS/**"/>
                <exclude name="Todo"/>
            </fileset>
        </copy>
        <tar destfile="../${composite.name}.tar.gz"
	        basedir="${dist-package}"
    	    includes="${composite.name}/"
         	compression="gzip"/>    	<!-- dpkg-source does not like anything else -->
    	<delete dir="${dist-package}"/>
    </target>

    <target name="clean">
        <delete dir="${output..}"/>
        <delete dir="${tmp.dir}"/>
    </target>

</project>
