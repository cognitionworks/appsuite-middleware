--- !com.openexchange.subscribe.crawler.CrawlerDescription
displayName: Facebook
id: com.openexchange.subscribe.crawler.facebook
workflowString: |
  --- !com.openexchange.subscribe.crawler.Workflow
  steps: 
    - !com.openexchange.subscribe.crawler.LoginPageByFormActionStep
      actionOfLoginForm: "https://login.facebook.com/login.php?"
      baseUrl: "https://m.facebook.com"
      description: Login to facebook.com
      linkAvailableAfterLogin: "(\\/friends.*)"
      nameOfPasswordField: pass
      nameOfUserField: email
      numberOfForm: 1
      pageTitleAfterLogin: "(\\/friends.*)"
      password: ""
      url: "https://m.facebook.com/"
      username: ""
    - !com.openexchange.subscribe.crawler.PageByLinkRegexStep
      description: click the friends-link
      url: "\\/friends.*"
    - !com.openexchange.subscribe.crawler.PageByLinkRegexStep
      description: click the all-link
      url: "\\/friends.php?.*&a.*"
    - !com.openexchange.subscribe.crawler.AnchorsByLinkRegexStep
      description: click all the individual friends links on all subpages.
      identifyingCriteria: ".*&id=([0-9]*)&.*"
      linkRegex: "\\/profile.php.*&id.*"
      subpageLinkRegex: "\\/friends.php?.*&a&f.*"
    - !com.openexchange.subscribe.crawler.ContactObjectsByHTMLAnchorsAndPagePartSequenceStep
      description: Get the info-bits from the contact-page.
      linkToTargetPage: ".*&v=info.*"
      pageParts: !com.openexchange.subscribe.crawler.PagePartSequence
        page: ""
        pageParts: 
          - !com.openexchange.subscribe.crawler.PagePart
            regex: "(<div class=\"section_title\">)([^<]*)(</div>)"
            type: 1
            typeOfInfo: display_name
          - !com.openexchange.subscribe.crawler.PagePart
            regex: "(<img src=\")([^\"]*)(\")"
            type: 1
            typeOfInfo: image
          - !com.openexchange.subscribe.crawler.PagePart
            regex: "(AIM|Google Talk|Skype|Windows Live|Yahoo):<\\/td><td  valign=\"top\">([^<]*)(</td>)"
            type: 1
            typeOfInfo: instant_messenger1
          - !com.openexchange.subscribe.crawler.PagePart
            regex: "(Mobile Number|Handynummer):</td><td ><a href=\"tel:[0-9]*\">([0-9\\s\\+\\-\\/\\(\\)]*)(<\\/a>)"
            type: 1
            typeOfInfo: cellular_telephone1
          - !com.openexchange.subscribe.crawler.PagePart
            regex: "(Phone|Telefon):</td><td ><a href=\"tel:[0-9]*\">([0-9\\s\\+\\-\\/\\(\\)]*)(<\\/a>)"
            type: 1
            typeOfInfo: telephone_business1
          - !com.openexchange.subscribe.crawler.PagePart
            regex: "(Current Address|Aktuelle Adresse):<\\/td><td  valign=\"top\">(.+?)(<\\/td>)"
            type: 1
            typeOfInfo: address_note
          - !com.openexchange.subscribe.crawler.PagePart
            regex: "(Member of|Mitglied von):<\\/td><td  valign=\"top\">(.+?)(<\\/td>)"
            type: 1
            typeOfInfo: company
          - !com.openexchange.subscribe.crawler.PagePart
            regex: "(Hometown|Heimatstadt):<\\/td><td  valign=\"top\">(.+?)(<\\/td>)"
            type: 1
            typeOfInfo: city_home
      titleExceptionsRegex: "Facebook.*(Your Profile|Dein Profil)"
  
