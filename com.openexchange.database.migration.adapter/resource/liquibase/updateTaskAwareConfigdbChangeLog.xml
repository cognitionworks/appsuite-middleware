<?xml version="1.0" encoding="UTF-8"?>

<!-- *************************************************************************************
    Hints:
       - changeSet id has to be unique as it is used as primary key for DATABASECHANGELOG table
       - use failOnError param to define if a successful execution of the ChangeSet is required
       - DDLs for the configdb have additionally be considered within the configdb.sql file (for new installations)
 ************************************************************************************* -->

<databaseChangeLog xmlns="urn:liquibase"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="urn:liquibase /liquibase/dbchangelog-3.0.xsd"
    logicalFilePath="updateTaskAwareConfigdbChangeLog">

 	<changeSet id="7.10.0:configdb:toUtf8Mb4" author="martin.schneider@open-xchange.com" failOnError="false">
		<comment>Converts the table/column definition to support utf8mb4</comment>
		<customChange class="com.openexchange.database.migration.adapter.configdb.ConfigDbToUtf8mb4Change" />
	</changeSet>

 	<changeSet id="7.10.0:reseller:toUtf8Mb4" author="martin.schneider@open-xchange.com" failOnError="false">
		<comment>Converts the table/column definition to support utf8mb4</comment>
		<customChange class="com.openexchange.database.migration.adapter.configdb.ResellerToUtf8mb4Change" />
	</changeSet>
	
 	<changeSet id="7.10.0:advertisement_config:toUtf8Mb4" author="martin.schneider@open-xchange.com" failOnError="false">
		<preConditions onFail="CONTINUE">
			<changeSetExecuted id="7.8.3:advertisement_config:createForConfigDB" author="kevin.ruthmann@open-xchange.com" changeLogFile="configdbChangeLog" />
		</preConditions>
		<comment>Converts the table/column definition to support utf8mb4</comment>
		<customChange class="com.openexchange.database.migration.adapter.configdb.table.AdvertisementConfigToUtf8mb4Change" />
	</changeSet>

 	<changeSet id="7.10.0:advertisement_mapping:toUtf8Mb4" author="martin.schneider@open-xchange.com" failOnError="false">
		<preConditions onFail="CONTINUE">
			<changeSetExecuted id="7.8.3:advertisement_mapping:createForConfigDB" author="kevin.ruthmann@open-xchange.com" changeLogFile="configdbChangeLog" />
		</preConditions>
		<comment>Converts the table/column definition to support utf8mb4</comment>
		<customChange class="com.openexchange.database.migration.adapter.configdb.table.AdvertisementMappingToUtf8mb4Change" />
	</changeSet>

 	<changeSet id="7.10.0:context2push_registration:toUtf8Mb4" author="martin.schneider@open-xchange.com" failOnError="false">
		<preConditions onFail="CONTINUE">
			<changeSetExecuted id="7.6.2:context2push_registration" author="thorben.betten@open-xchange.com" changeLogFile="configdbChangeLog" />
		</preConditions>
		<comment>Converts the table/column definition to support utf8mb4</comment>
		<customChange class="com.openexchange.database.migration.adapter.configdb.table.Context2pushRegistrationToUtf8mb4Change" />
	</changeSet>

 	<changeSet id="7.10.0:filestore2user:toUtf8Mb4" author="martin.schneider@open-xchange.com" failOnError="false">
		<preConditions onFail="CONTINUE">
			<changeSetExecuted id="7.8.2:filestore2user" author="thorben.betten@open-xchange.com" changeLogFile="configdbChangeLog" />
		</preConditions>
		<comment>Converts the table/column definition to support utf8mb4</comment>
		<customChange class="com.openexchange.database.migration.adapter.configdb.table.Filestore2userToUtf8mb4Change" />
	</changeSet>

 	<changeSet id="7.10.0:replicationMonitor:toUtf8Mb4" author="martin.schneider@open-xchange.com" failOnError="false">
		<preConditions onFail="CONTINUE">
			<changeSetExecuted id="7.8.1:replicationMonitor:createForConfigDB" author="martin.schneider@open-xchange.com" changeLogFile="configdbChangeLog" />
		</preConditions>
		<comment>Converts the table/column definition to support utf8mb4</comment>
		<customChange class="com.openexchange.database.migration.adapter.configdb.table.ReplicationMonitorToUtf8mb4Change" />
	</changeSet>
	
 	<changeSet id="7.10.0:countTables:toUtf8Mb4" author="martin.schneider@open-xchange.com" failOnError="false">
		<preConditions onFail="CONTINUE">
			<changeSetExecuted id="7.10:com.openexchange.database.migration:createcounttables" author="thorben.betten@open-xchange.com" changeLogFile="configdbChangeLog" />
		</preConditions>
		<comment>Converts the table/column definition to support utf8mb4</comment>
		<customChange class="com.openexchange.database.migration.adapter.configdb.table.CountTablesToUtf8mb4Change" />
	</changeSet>
	
</databaseChangeLog>
